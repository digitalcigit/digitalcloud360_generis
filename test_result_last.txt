============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
configfile: pytest.ini
plugins: anyio-4.12.0, mock-3.15.1, Faker-39.0.0, asyncio-1.3.0, langsmith-0.5.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collected 6 items

tests/test_e2e/test_coaching_flow.py EF                                  [ 33%]
tests/test_e2e/test_coaching_silver_features.py FFFF                     [100%]

==================================== ERRORS ====================================
_ ERROR at setup of TestCoachingFlowE2E.test_full_coaching_to_site_generation __
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:550: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py:241: in __bind_execute
    data, status, _ = await self.__do_execute(
/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py:230: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:207: in bind_execute
    ???
E   asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "ix_users_email"
E   DETAIL:  Key (email)=(test@example.com) already exists.

The above exception was the direct cause of the following exception:
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py:952: in do_execute
    cursor.execute(statement, parameters)
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:585: in execute
    self._adapt_connection.await_(
/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:563: in _prepare_and_execute
    self._handle_exception(error)
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:513: in _handle_exception
    self._adapt_connection._handle_exception(error)
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:797: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_email"
E   DETAIL:  Key (email)=(test@example.com) already exists.

The above exception was the direct cause of the following exception:
/usr/local/lib/python3.11/site-packages/pytest_asyncio/plugin.py:458: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/pytest_asyncio/plugin.py:743: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
/usr/local/lib/python3.11/site-packages/pytest_asyncio/plugin.py:361: in _async_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/asyncio/runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/asyncio/base_events.py:654: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/pytest_asyncio/plugin.py:357: in setup
    res = await fixture_function(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/conftest_docker.py:97: in test_user_docker
    await db_session_docker.commit()
/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py:1000: in commit
    await greenlet_spawn(self.sync_session.commit)
/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py:2030: in commit
    trans.commit(_to_root=True)
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py:1311: in commit
    self._prepare_impl()
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py:137: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py:1286: in _prepare_impl
    self.session.flush()
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py:4331: in flush
    self._flush(objects)
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py:4466: in _flush
    with util.safe_reraise():
/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py:4427: in _flush
    flush_context.execute()
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
    rec.execute(self)
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
    util.preloaded.orm_persistence.save_obj(
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
    _emit_insert_statements(
/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
    result = connection.execute(
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py:527: in _execute_on_connection
    return connection._execute_clauseelement(
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py:2363: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py:952: in do_execute
    cursor.execute(statement, parameters)
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:585: in execute
    self._adapt_connection.await_(
/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:563: in _prepare_and_execute
    self._handle_exception(error)
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:513: in _handle_exception
    self._adapt_connection._handle_exception(error)
/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:797: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_email"
E   DETAIL:  Key (email)=(test@example.com) already exists.
E   [SQL: INSERT INTO users (email, name, hashed_password, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, now(), now()) RETURNING users.id, users.created_at, users.updated_at]
E   [parameters: ('test@example.com', 'Test User Docker', '$2b$12$V/OIPUbZPBmwsjut5j3EMuEowc3dm8bM7c2PU5DwUqaPCx.QGZHDy')]
E   (Background on this error at: https://sqlalche.me/e/20/gkpj)
---------------------------- Captured stdout setup -----------------------------
2025-12-20 07:41:30 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/auth/token
2025-12-20 07:41:30 [info     ] Request completed              duration_seconds=0.5043632984161377 method=POST status_code=200 url=http://testserver/api/v1/auth/token
---------------------------- Captured stderr setup -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
------------------------------ Captured log setup ------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
=================================== FAILURES ===================================
_____________ TestCoachingFlowE2E.test_coaching_validation_failure _____________
tests/test_e2e/test_coaching_flow.py:90: in test_coaching_validation_failure
    assert data["current_step"] == CoachingStepEnum.VISION.value
E   AssertionError: assert 'mission' == 'vision'
E     
E     - vision
E     ? ^
E     + mission
E     ? ^ +
---------------------------- Captured stdout setup -----------------------------
2025-12-20 07:41:35 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/auth/token
2025-12-20 07:41:35 [info     ] Request completed              duration_seconds=0.48213791847229004 method=POST status_code=200 url=http://testserver/api/v1/auth/token
---------------------------- Captured stderr setup -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
------------------------------ Captured log setup ------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
2025-12-20 07:41:35 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/coaching/start
2025-12-20 07:41:35 [info     ] PromptsLoader initialized with 5 coaching steps
2025-12-20 07:41:35 [info     ] Request completed              duration_seconds=0.07540631294250488 method=POST status_code=200 url=http://testserver/api/v1/coaching/start
2025-12-20 07:41:35 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/coaching/step
2025-12-20 07:41:36 [info     ] Création LLM provider          model=deepseek-chat plan=genesis_basic provider=deepseek
2025-12-20 07:41:36 [info     ] DeepseekProvider initialized   base_url=https://api.deepseek.com model=deepseek-chat
2025-12-20 07:41:36 [info     ] PromptsLoader initialized with 5 coaching steps
2025-12-20 07:41:36 [info     ] CoachingLLMService initialized with Deepseek provider
2025-12-20 07:41:36 [info     ] PromptsLoader initialized with 5 coaching steps
2025-12-20 07:41:36 [info     ] Deepseek generate request      model=deepseek-chat prompt_length=622 temperature=0.1
2025-12-20 07:41:36 [error    ] Deepseek API error             response='{"error":{"message":"Authentication Fails, Your api key: ****-key is invalid","type":"authentication_error","param":null,"code":"invalid_request_error"}}' status_code=401
2025-12-20 07:41:36 [error    ] sector_detection_failed        error='Deepseek API error: 401'
2025-12-20 07:41:36 [info     ] requesting_llm_extraction      sector=default step=vision
2025-12-20 07:41:36 [info     ] Deepseek generate_structured request
2025-12-20 07:41:36 [info     ] Deepseek generate request      model=deepseek-chat prompt_length=1314 temperature=0.3
2025-12-20 07:41:37 [error    ] Deepseek API error             response='{"error":{"message":"Authentication Fails, Your api key: ****-key is invalid","type":"authentication_error","param":null,"code":"invalid_request_error"}}' status_code=401
2025-12-20 07:41:37 [error    ] llm_extraction_failed          error='Deepseek API error: 401' step=vision
2025-12-20 07:41:37 [info     ] Request completed              duration_seconds=1.2399985790252686 method=POST status_code=200 url=http://testserver/api/v1/coaching/step
----------------------------- Captured stderr call -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/coaching/start "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
INFO:httpx:HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
INFO:httpx:HTTP Request: POST http://testserver/api/v1/coaching/step "HTTP/1.1 200 OK"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/coaching/start "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
INFO     httpx:_client.py:1740 HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/coaching/step "HTTP/1.1 200 OK"
__________ TestSilverCoachingFeaturesE2E.test_coaching_help_socratic ___________
tests/test_e2e/test_coaching_silver_features.py:29: in test_coaching_help_socratic
    assert len(data["socratic_questions"]) >= 2
E   assert 0 >= 2
E    +  where 0 = len([])
---------------------------- Captured stdout setup -----------------------------
2025-12-20 07:41:38 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/auth/token
2025-12-20 07:41:38 [info     ] Request completed              duration_seconds=0.4897880554199219 method=POST status_code=200 url=http://testserver/api/v1/auth/token
---------------------------- Captured stderr setup -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
------------------------------ Captured log setup ------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
2025-12-20 07:41:38 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/coaching/start
2025-12-20 07:41:38 [info     ] PromptsLoader initialized with 5 coaching steps
2025-12-20 07:41:38 [info     ] Request completed              duration_seconds=0.061090946197509766 method=POST status_code=200 url=http://testserver/api/v1/coaching/start
2025-12-20 07:41:38 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/coaching/help
2025-12-20 07:41:38 [info     ] Création LLM provider          model=deepseek-chat plan=genesis_basic provider=deepseek
2025-12-20 07:41:38 [info     ] DeepseekProvider initialized   base_url=https://api.deepseek.com model=deepseek-chat
2025-12-20 07:41:38 [info     ] PromptsLoader initialized with 5 coaching steps
2025-12-20 07:41:38 [info     ] CoachingLLMService initialized with Deepseek provider
2025-12-20 07:41:38 [info     ] Deepseek generate_structured request
2025-12-20 07:41:38 [info     ] Deepseek generate request      model=deepseek-chat prompt_length=601 temperature=0.3
2025-12-20 07:41:39 [error    ] Deepseek API error             response='{"error":{"message":"Authentication Fails, Your api key: ****-key is invalid","type":"authentication_error","param":null,"code":"invalid_request_error"}}' status_code=401
2025-12-20 07:41:39 [error    ] socratic_help_failed           error='Deepseek API error: 401'
2025-12-20 07:41:39 [info     ] Request completed              duration_seconds=0.6243700981140137 method=POST status_code=200 url=http://testserver/api/v1/coaching/help
----------------------------- Captured stderr call -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/coaching/start "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
INFO:httpx:HTTP Request: POST http://testserver/api/v1/coaching/help "HTTP/1.1 200 OK"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/coaching/start "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/coaching/help "HTTP/1.1 200 OK"
__________ TestSilverCoachingFeaturesE2E.test_reformulate_on_the_fly ___________
tests/test_e2e/test_coaching_silver_features.py:45: in test_reformulate_on_the_fly
    assert response.status_code == 200
E   assert 422 == 200
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-20 07:41:40 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/auth/token
2025-12-20 07:41:41 [info     ] Request completed              duration_seconds=0.5013902187347412 method=POST status_code=200 url=http://testserver/api/v1/auth/token
---------------------------- Captured stderr setup -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
------------------------------ Captured log setup ------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
2025-12-20 07:41:41 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/coaching/reformulate
2025-12-20 07:41:41 [info     ] Request completed              duration_seconds=0.055866241455078125 method=POST status_code=422 url=http://testserver/api/v1/coaching/reformulate
----------------------------- Captured stderr call -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/coaching/reformulate "HTTP/1.1 422 Unprocessable Entity"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/coaching/reformulate "HTTP/1.1 422 Unprocessable Entity"
_________ TestSilverCoachingFeaturesE2E.test_reformulate_short_circuit _________
tests/test_e2e/test_coaching_silver_features.py:59: in test_reformulate_short_circuit
    assert response.status_code == 200
E   assert 422 == 200
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-20 07:41:42 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/auth/token
2025-12-20 07:41:42 [info     ] Request completed              duration_seconds=0.49434471130371094 method=POST status_code=200 url=http://testserver/api/v1/auth/token
---------------------------- Captured stderr setup -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
------------------------------ Captured log setup ------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
2025-12-20 07:41:42 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/coaching/reformulate
2025-12-20 07:41:42 [info     ] Request completed              duration_seconds=0.011255264282226562 method=POST status_code=422 url=http://testserver/api/v1/coaching/reformulate
----------------------------- Captured stderr call -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/coaching/reformulate "HTTP/1.1 422 Unprocessable Entity"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/coaching/reformulate "HTTP/1.1 422 Unprocessable Entity"
____________ TestSilverCoachingFeaturesE2E.test_generate_proposals _____________
tests/test_e2e/test_coaching_silver_features.py:79: in test_generate_proposals
    assert len(data["proposals"]) == 3
E   assert 0 == 3
E    +  where 0 = len([])
---------------------------- Captured stdout setup -----------------------------
2025-12-20 07:41:44 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/auth/token
2025-12-20 07:41:44 [info     ] Request completed              duration_seconds=0.5797679424285889 method=POST status_code=200 url=http://testserver/api/v1/auth/token
---------------------------- Captured stderr setup -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
------------------------------ Captured log setup ------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/auth/token "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
2025-12-20 07:41:44 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/coaching/start
2025-12-20 07:41:44 [info     ] PromptsLoader initialized with 5 coaching steps
2025-12-20 07:41:44 [info     ] Request completed              duration_seconds=0.04078841209411621 method=POST status_code=200 url=http://testserver/api/v1/coaching/start
2025-12-20 07:41:44 [info     ] Request started                client_ip=127.0.0.1 method=POST url=http://testserver/api/v1/coaching/generate-proposals
2025-12-20 07:41:44 [info     ] Création LLM provider          model=deepseek-chat plan=genesis_basic provider=deepseek
2025-12-20 07:41:44 [info     ] DeepseekProvider initialized   base_url=https://api.deepseek.com model=deepseek-chat
2025-12-20 07:41:44 [info     ] PromptsLoader initialized with 5 coaching steps
2025-12-20 07:41:44 [info     ] CoachingLLMService initialized with Deepseek provider
2025-12-20 07:41:44 [info     ] Deepseek generate_structured request
2025-12-20 07:41:44 [info     ] Deepseek generate request      model=deepseek-chat prompt_length=622 temperature=0.3
2025-12-20 07:41:45 [error    ] Deepseek API error             response='{"error":{"message":"Authentication Fails, Your api key: ****-key is invalid","type":"authentication_error","param":null,"code":"invalid_request_error"}}' status_code=401
2025-12-20 07:41:45 [error    ] proposals_generation_failed    error='Deepseek API error: 401'
2025-12-20 07:41:45 [info     ] Request completed              duration_seconds=0.6064310073852539 method=POST status_code=200 url=http://testserver/api/v1/coaching/generate-proposals
----------------------------- Captured stderr call -----------------------------
INFO:httpx:HTTP Request: POST http://testserver/api/v1/coaching/start "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
INFO:httpx:HTTP Request: POST http://testserver/api/v1/coaching/generate-proposals "HTTP/1.1 200 OK"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/coaching/start "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
INFO     httpx:_client.py:1740 HTTP Request: POST http://testserver/api/v1/coaching/generate-proposals "HTTP/1.1 200 OK"
=========================== short test summary info ============================
ERROR tests/test_e2e/test_coaching_flow.py::TestCoachingFlowE2E::test_full_coaching_to_site_generation
FAILED tests/test_e2e/test_coaching_flow.py::TestCoachingFlowE2E::test_coaching_validation_failure
FAILED tests/test_e2e/test_coaching_silver_features.py::TestSilverCoachingFeaturesE2E::test_coaching_help_socratic
FAILED tests/test_e2e/test_coaching_silver_features.py::TestSilverCoachingFeaturesE2E::test_reformulate_on_the_fly
FAILED tests/test_e2e/test_coaching_silver_features.py::TestSilverCoachingFeaturesE2E::test_reformulate_short_circuit
FAILED tests/test_e2e/test_coaching_silver_features.py::TestSilverCoachingFeaturesE2E::test_generate_proposals
=================== 5 failed, 21 warnings, 1 error in 18.12s ===================
